(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/tui-chat/message-input/index"],{239:function(e,t,n){"use strict";n.r(t);var s=n(240),i=n(242);for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n(244);var o,r=n(53),c=Object(r["default"])(i["default"],s["render"],s["staticRenderFns"],!1,null,null,null,!1,s["components"],o);c.options.__file="components/tui-chat/message-input/index.vue",t["default"]=c.exports},240:function(e,t,n){"use strict";n.r(t);var s=n(241);n.d(t,"render",(function(){return s["render"]})),n.d(t,"staticRenderFns",(function(){return s["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return s["recyclableRender"]})),n.d(t,"components",(function(){return s["components"]}))},241:function(e,t,n){"use strict";var s;n.r(t),n.d(t,"render",(function(){return i})),n.d(t,"staticRenderFns",(function(){return o})),n.d(t,"recyclableRender",(function(){return a})),n.d(t,"components",(function(){return s}));var i=function(){var e=this,t=e.$createElement;e._self._c},a=!1,o=[];i._withStripped=!0},242:function(e,t,n){"use strict";n.r(t);var s=n(243),i=n.n(s);for(var a in s)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return s[e]}))}(a);t["default"]=i.a},243:function(e,t,n){"use strict";(function(e){var s=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(n(46));var i=function(){Promise.all([n.e("common/vendor"),n.e("components/tui-chat/message-elements/emoji/index")]).then(function(){return resolve(n(424))}.bind(null,n)).catch(n.oe)},a=function(){n.e("components/tui-chat/message-private/common-words/index").then(function(){return resolve(n(431))}.bind(null,n)).catch(n.oe)},o=function(){n.e("components/tui-chat/message-private/order-list/index").then(function(){return resolve(n(438))}.bind(null,n)).catch(n.oe)},r=function(){n.e("components/tui-chat/message-private/service-evaluation/index").then(function(){return resolve(n(445))}.bind(null,n)).catch(n.oe)},c={data:function(){return{firstSendMessage:!0,inputText:"",extensionArea:!1,sendMessageBtn:!1,displayFlag:"",isAudio:!1,bottomVal:0,startPoint:0,popupToggle:!1,isRecording:!1,canSend:!0,text:"按住说话",title:" ",notShow:!1,isShow:!0,recordTime:0,recordTimer:null,displayServiceEvaluation:!1,displayCommonWords:!1,displayOrderList:!1}},components:{TUIEmoji:i,TUICommonWords:a,TUIOrderList:o,TUIServiceEvaluation:r},props:{conversation:{type:Object,default:function(){}}},watch:{conversation:{handler:function(e){},immediate:!0,deep:!0}},beforeMount:function(){var t=this;this.recorderManager=e.getRecorderManager(),this.recorderManager.onStop((function(n){clearInterval(t.recordTimer);var s={duration:n.duration?n.duration:1e3*t.recordTime,tempFilePath:n.tempFilePath,fileSize:n.fileSize?n.fileSize:48*t.recordTime/8*1024};if(e.hideLoading(),t.canSend)if(s.duration<1e3)e.showToast({title:"录音时间太短",icon:"none"});else{var i=e.$TUIKit.createAudioMessage({to:t.getToAccount(),conversationType:t.conversation.type,payload:{file:s}});t.$sendTIMMessage(i)}t.setData({startPoint:0,popupToggle:!1,isRecording:!1,canSend:!0,title:" ",text:"按住说话"})}))},methods:{switchAudio:function(){this.setData({isAudio:!this.isAudio,text:"按住说话"})},handleLongPress:function(e){var t=this;this.recorderManager.start({duration:6e4,sampleRate:44100,numberOfChannels:1,encodeBitRate:192e3,format:"aac"}),this.setData({startPoint:e.touches[0],title:"正在录音",notShow:!0,isShow:!1,isRecording:!0,popupToggle:!0,recordTime:0}),this.recordTimer=setInterval((function(){t.recordTime++}),1e3)},handleTouchMove:function(e){this.isRecording&&(this.startPoint.clientY-e.touches[e.touches.length-1].clientY>100?this.setData({text:"抬起停止",title:"松开手指，取消发送",canSend:!1}):this.startPoint.clientY-e.touches[e.touches.length-1].clientY>20?this.setData({text:"抬起停止",title:"上划可取消",canSend:!0}):this.setData({text:"抬起停止",title:"正在录音",canSend:!0}))},handleTouchEnd:function(){this.setData({isRecording:!1,popupToggle:!1}),e.hideLoading(),this.recorderManager.stop()},handleEmoji:function(){var e="emoji";"emoji"===this.displayFlag&&(e=""),this.setData({displayFlag:e})},handleExtensions:function(){var e="extension";"extension"===this.displayFlag&&(e=""),this.setData({displayFlag:e})},error:function(e){console.log(e.detail)},handleSendPicture:function(){this.sendImageMessage("camera")},handleSendImage:function(){this.sendImageMessage("album")},sendImageMessage:function(t){var n=this;e.chooseImage({sourceType:[t],count:1,success:function(t){if(t){var s=e.$TUIKit.createImageMessage({to:n.getToAccount(),conversationType:n.conversation.type,payload:{file:t},onProgress:function(e){s.percent=e}});n.$sendTIMMessage(s)}}})},handleShootVideo:function(){this.sendVideoMessage("camera")},handleSendVideo:function(){this.sendVideoMessage("album")},sendVideoMessage:function(t){var n=this;e.chooseVideo({sourceType:[t],maxDuration:60,camera:"back",success:function(t){if(t){var s=e.$TUIKit.createVideoMessage({to:n.getToAccount(),conversationType:n.conversation.type,payload:{file:t},onProgress:function(e){s.percent=e}});n.$sendTIMMessage(s)}}})},handleSendOrder:function(){this.setData({displayOrderList:!0})},appendMessage:function(e){this.setData({inputText:this.inputText+e.detail.message,sendMessageBtn:!0})},getToAccount:function(){if(!this.conversation||!this.conversation.conversationID)return"";switch(this.conversation.type){case"C2C":return this.conversation.conversationID.replace("C2C","");case"GROUP":return this.conversation.conversationID.replace("GROUP","");default:return this.conversation.conversationID}},handleCalling:function(t){if("GROUP"!==this.conversation.type){this.conversation.userProfile.userID;e.showToast({title:"微信小程序暂不支持",icon:"none"})}else e.showToast({title:"群聊暂不支持",icon:"none"})},sendTextMessage:function(t,n){var s=this.getToAccount(),i=n?t:this.inputText,a=e.$TUIKit.createTextMessage({to:s,conversationType:this.conversation.type,payload:{text:i}});this.setData({inputText:"",sendMessageBtn:!1}),this.$sendTIMMessage(a)},onInputValueChange:function(e){e.detail.value?this.setData({sendMessageBtn:!0}):this.setData({sendMessageBtn:!1})},$handleSendTextMessage:function(e){this.sendTextMessage(e.detail.message,!0),this.setData({displayCommonWords:!1})},$handleSendCustomMessage:function(t){var n=e.$TUIKit.createCustomMessage({to:this.getToAccount(),conversationType:this.conversation.type,payload:t.detail.payload});this.$sendTIMMessage(n),this.setData({displayOrderList:!1})},$handleCloseCards:function(e){switch(e.detail.key){case"0":this.setData({displayCommonWords:!1});break;case"1":this.setData({displayOrderList:!1});break;case"2":this.setData({displayServiceEvaluation:!1});break;default:break}},$sendTIMMessage:function(t){var n=this,s=getApp().globalData.SDKAppID;this.$emit("sendMessage",{detail:{message:t}}),e.$TUIKit.sendMessage(t).then((function(t){n.firstSendMessage&&e.$aegis.reportEvent({name:"sendMessage",ext1:"sendMessage-success",ext2:"uniTuikitExternal",ext3:"".concat(s)}),n.firstSendMessage=!1})).catch((function(t){e.$aegis.reportEvent({name:"sendMessage",ext1:"sendMessage-failed#error: ".concat(t),ext2:"uniTuikitExternal",ext3:"".concat(s)})})),this.setData({displayFlag:""})},handleClose:function(){this.setData({displayFlag:""})},handleServiceEvaluation:function(){this.setData({displayServiceEvaluation:!0})},inputBindFocus:function(){console.log("占位：函数 inputBindFocus 未声明")},inputBindBlur:function(){console.log("占位：函数 inputBindBlur 未声明")}}};t.default=c}).call(this,n(2)["default"])},244:function(e,t,n){"use strict";n.r(t);var s=n(245),i=n.n(s);for(var a in s)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return s[e]}))}(a);t["default"]=i.a},245:function(e,t,n){}}]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/components/tui-chat/message-input/index.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/tui-chat/message-input/index-create-component',
    {
        'components/tui-chat/message-input/index-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('2')['createComponent'](__webpack_require__(239))
        })
    },
    [['components/tui-chat/message-input/index-create-component']]
]);
