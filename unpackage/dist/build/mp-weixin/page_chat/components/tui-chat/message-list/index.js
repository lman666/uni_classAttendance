require('../../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["page_chat/components/tui-chat/message-list/index"],{"9cad":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var s=function(){var e=this.$createElement;this._self._c},a=[]},a585:function(e,t,n){"use strict";n.r(t);var s=n("9cad"),a=n("b3c3");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("b70b");var o=n("f0c5"),c=Object(o["a"])(a["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],void 0);t["default"]=c.exports},b3c3:function(e,t,n){"use strict";n.r(t);var s=n("f092"),a=n.n(s);for(var i in s)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return s[e]}))}(i);t["default"]=a.a},b70b:function(e,t,n){"use strict";var s=n("ccb3"),a=n.n(s);a.a},ccb3:function(e,t,n){},f092:function(e,t,n){"use strict";(function(e){var s=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(n("448a")),i={data:function(){return{avatar:"",userID:"",messageList:[],scrollView:"",scrollTop:0,triggered:!0,nextReqMessageID:"",isCompleted:!1}},components:{TUITextMessage:function(){Promise.all([n.e("page_chat/common/vendor"),n.e("page_chat/components/tui-chat/message-elements/text-message/index")]).then(function(){return resolve(n("70c7"))}.bind(null,n)).catch(n.oe)},TUIImageMessage:function(){Promise.all([n.e("page_chat/common/vendor"),n.e("page_chat/components/tui-chat/message-elements/image-message/index")]).then(function(){return resolve(n("078e"))}.bind(null,n)).catch(n.oe)},TUIVideoMessage:function(){Promise.all([n.e("page_chat/common/vendor"),n.e("page_chat/components/tui-chat/message-elements/video-message/index")]).then(function(){return resolve(n("fbdf"))}.bind(null,n)).catch(n.oe)},TUIAudioMessage:function(){n.e("page_chat/components/tui-chat/message-elements/audio-message/index").then(function(){return resolve(n("b9a8"))}.bind(null,n)).catch(n.oe)},TUICustomMessage:function(){Promise.all([n.e("common/vendor"),n.e("page_chat/components/tui-chat/message-elements/custom-message/index")]).then(function(){return resolve(n("d889"))}.bind(null,n)).catch(n.oe)},TUITipMessage:function(){Promise.all([n.e("page_chat/common/vendor"),n.e("page_chat/components/tui-chat/message-elements/tip-message/index")]).then(function(){return resolve(n("a117"))}.bind(null,n)).catch(n.oe)},TUISystemMessage:function(){Promise.all([n.e("common/vendor"),n.e("page_chat/common/vendor"),n.e("page_chat/components/tui-chat/message-elements/system-message/index")]).then(function(){return resolve(n("dafd"))}.bind(null,n)).catch(n.oe)},TUIFaceMessage:function(){n.e("page_chat/components/tui-chat/message-elements/face-message/index").then(function(){return resolve(n("8da9"))}.bind(null,n)).catch(n.oe)},TUIFileMessage:function(){n.e("page_chat/components/tui-chat/message-elements/file-message/index").then(function(){return resolve(n("92e1"))}.bind(null,n)).catch(n.oe)}},props:{conversation:{type:Object,default:function(){}}},watch:{conversation:{handler:function(e){var t=this;e.conversationID&&this.setData({conversation:e},(function(){t.getMessageList(e)}))},immediate:!0,deep:!0}},mounted:function(){var t=this;e.$TUIKit.getMyProfile().then((function(e){t.avatar=e.data.avatar,t.userID=e.data.userID})),e.$TUIKit.on(e.$TUIKitEvent.MESSAGE_RECEIVED,this.$onMessageReceived,this),e.$TUIKit.on(e.$TUIKitEvent.MESSAGE_READ_BY_PEER,this.$onMessageReadByPeer,this)},destroyed:function(){e.$TUIKit.off(e.$TUIKitEvent.MESSAGE_RECEIVED,this.$onMessageReceived)},methods:{refresh:function(){var e=this;this.isCompleted?this.setData({isCompleted:!0,triggered:!1}):(this.getMessageList(this.conversation),setTimeout((function(){e.setData({triggered:!1})}),2e3))},getMessageList:function(t){var n=this;this.isCompleted||e.$TUIKit.getMessageList({conversationID:t.conversationID,nextReqMessageID:this.nextReqMessageID,count:15}).then((function(e){var t=e.data.messageList;n.nextReqMessageID=e.data.nextReqMessageID,n.isCompleted=e.data.isCompleted,n.messageList=[].concat((0,a.default)(t),(0,a.default)(n.messageList)),n.$handleMessageRender(n.messageList,t)}))},updateMessageList:function(e){this.messageList=[].concat((0,a.default)(this.messageList),[e]),this.scrollToButtom()},$onMessageReadByPeer:function(){this.setData({messageList:this.messageList})},scrollToButtom:function(){var t=this,n=e.createSelectorQuery().in(this),s=n.select("#message-scroll");s.boundingClientRect((function(e){t.$nextTick((function(){t.scrollTop=e.height}))})).exec()},$onMessageReceived:function(e){var t=this,n=e,s=[];n.data.forEach((function(e){e.conversationID===t.conversation.conversationID&&s.push(Object.assign(e))})),this.messageList=this.messageList.concat(s),this.scrollToButtom()},$handleMessageRender:function(e){var t=this;e.length>0&&(this.setData({messageList:e},(function(){})),this.$nextTick((function(){t.scrollTop=9999})))}}};t.default=i}).call(this,n("543d")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'page_chat/components/tui-chat/message-list/index-create-component',
    {
        'page_chat/components/tui-chat/message-list/index-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("a585"))
        })
    },
    [['page_chat/components/tui-chat/message-list/index-create-component']]
]);
