require('../../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["page_chat/components/tui-chat/message-input/index"],{"29ab":function(e,t,n){"use strict";var a=n("4a7e"),s=n.n(a);s.a},"4a7e":function(e,t,n){},8805:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){}));var a=function(){var e=this.$createElement;this._self._c},s=[]},b051:function(e,t,n){"use strict";(function(e){var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;a(n("6a9e"));var s={data:function(){return{firstSendMessage:!0,inputText:"",extensionArea:!1,sendMessageBtn:!1,displayFlag:"",isAudio:!1,bottomVal:0,startPoint:0,popupToggle:!1,isRecording:!1,canSend:!0,text:"按住说话",title:" ",notShow:!1,isShow:!0,recordTime:0,recordTimer:null,displayServiceEvaluation:!1,displayCommonWords:!1,displayOrderList:!1}},components:{TUIEmoji:function(){Promise.all([n.e("page_chat/common/vendor"),n.e("page_chat/components/tui-chat/message-elements/emoji/index")]).then(function(){return resolve(n("478e"))}.bind(null,n)).catch(n.oe)},TUICommonWords:function(){n.e("page_chat/components/tui-chat/message-private/common-words/index").then(function(){return resolve(n("0a8c"))}.bind(null,n)).catch(n.oe)},TUIOrderList:function(){n.e("page_chat/components/tui-chat/message-private/order-list/index").then(function(){return resolve(n("e6d9"))}.bind(null,n)).catch(n.oe)},TUIServiceEvaluation:function(){n.e("page_chat/components/tui-chat/message-private/service-evaluation/index").then(function(){return resolve(n("417a"))}.bind(null,n)).catch(n.oe)}},props:{conversation:{type:Object,default:function(){}}},watch:{conversation:{handler:function(e){},immediate:!0,deep:!0}},beforeMount:function(){var t=this;this.recorderManager=e.getRecorderManager(),this.recorderManager.onStop((function(n){clearInterval(t.recordTimer);var a={duration:n.duration?n.duration:1e3*t.recordTime,tempFilePath:n.tempFilePath,fileSize:n.fileSize?n.fileSize:48*t.recordTime/8*1024};if(e.hideLoading(),t.canSend)if(a.duration<1e3)e.showToast({title:"录音时间太短",icon:"none"});else{var s=e.$TUIKit.createAudioMessage({to:t.getToAccount(),conversationType:t.conversation.type,payload:{file:a}});t.$sendTIMMessage(s)}t.setData({startPoint:0,popupToggle:!1,isRecording:!1,canSend:!0,title:" ",text:"按住说话"})}))},methods:{switchAudio:function(){this.setData({isAudio:!this.isAudio,text:"按住说话"})},handleLongPress:function(e){var t=this;this.recorderManager.start({duration:6e4,sampleRate:44100,numberOfChannels:1,encodeBitRate:192e3,format:"aac"}),this.setData({startPoint:e.touches[0],title:"正在录音",notShow:!0,isShow:!1,isRecording:!0,popupToggle:!0,recordTime:0}),this.recordTimer=setInterval((function(){t.recordTime++}),1e3)},handleTouchMove:function(e){this.isRecording&&(this.startPoint.clientY-e.touches[e.touches.length-1].clientY>100?this.setData({text:"抬起停止",title:"松开手指，取消发送",canSend:!1}):this.startPoint.clientY-e.touches[e.touches.length-1].clientY>20?this.setData({text:"抬起停止",title:"上划可取消",canSend:!0}):this.setData({text:"抬起停止",title:"正在录音",canSend:!0}))},handleTouchEnd:function(){this.setData({isRecording:!1,popupToggle:!1}),e.hideLoading(),this.recorderManager.stop()},handleEmoji:function(){var e="emoji";"emoji"===this.displayFlag&&(e=""),this.setData({displayFlag:e})},handleExtensions:function(){var e="extension";"extension"===this.displayFlag&&(e=""),this.setData({displayFlag:e})},error:function(e){console.log(e.detail)},handleSendPicture:function(){this.sendImageMessage("camera")},handleSendImage:function(){this.sendImageMessage("album")},sendImageMessage:function(t){var n=this;e.chooseImage({sourceType:[t],count:1,success:function(t){if(t){var a=e.$TUIKit.createImageMessage({to:n.getToAccount(),conversationType:n.conversation.type,payload:{file:t},onProgress:function(e){a.percent=e}});n.$sendTIMMessage(a)}}})},handleShootVideo:function(){this.sendVideoMessage("camera")},handleSendVideo:function(){this.sendVideoMessage("album")},sendVideoMessage:function(t){var n=this;e.chooseVideo({sourceType:[t],maxDuration:60,camera:"back",success:function(t){if(t){var a=e.$TUIKit.createVideoMessage({to:n.getToAccount(),conversationType:n.conversation.type,payload:{file:t},onProgress:function(e){a.percent=e}});n.$sendTIMMessage(a)}}})},handleSendOrder:function(){this.setData({displayOrderList:!0})},appendMessage:function(e){this.setData({inputText:this.inputText+e.detail.message,sendMessageBtn:!0})},getToAccount:function(){if(!this.conversation||!this.conversation.conversationID)return"";switch(this.conversation.type){case"C2C":return this.conversation.conversationID.replace("C2C","");case"GROUP":return this.conversation.conversationID.replace("GROUP","");default:return this.conversation.conversationID}},handleCalling:function(t){if("GROUP"!==this.conversation.type){this.conversation.userProfile.userID;e.showToast({title:"微信小程序暂不支持",icon:"none"})}else e.showToast({title:"群聊暂不支持",icon:"none"})},sendTextMessage:function(t,n){var a=this.getToAccount(),s=n?t:this.inputText,i=e.$TUIKit.createTextMessage({to:a,conversationType:this.conversation.type,payload:{text:s}});this.setData({inputText:"",sendMessageBtn:!1}),this.$sendTIMMessage(i)},onInputValueChange:function(e){e.detail.value?this.setData({sendMessageBtn:!0}):this.setData({sendMessageBtn:!1})},$handleSendTextMessage:function(e){this.sendTextMessage(e.detail.message,!0),this.setData({displayCommonWords:!1})},$handleSendCustomMessage:function(t){var n=e.$TUIKit.createCustomMessage({to:this.getToAccount(),conversationType:this.conversation.type,payload:t.detail.payload});this.$sendTIMMessage(n),this.setData({displayOrderList:!1})},$handleCloseCards:function(e){switch(e.detail.key){case"0":this.setData({displayCommonWords:!1});break;case"1":this.setData({displayOrderList:!1});break;case"2":this.setData({displayServiceEvaluation:!1});break;default:break}},$sendTIMMessage:function(t){var n=this,a=getApp().globalData.SDKAppID;this.$emit("sendMessage",{detail:{message:t}}),e.$TUIKit.sendMessage(t).then((function(t){n.firstSendMessage&&e.$aegis.reportEvent({name:"sendMessage",ext1:"sendMessage-success",ext2:"uniTuikitExternal",ext3:"".concat(a)}),n.firstSendMessage=!1})).catch((function(t){e.$aegis.reportEvent({name:"sendMessage",ext1:"sendMessage-failed#error: ".concat(t),ext2:"uniTuikitExternal",ext3:"".concat(a)})})),this.setData({displayFlag:""})},handleClose:function(){this.setData({displayFlag:""})},handleServiceEvaluation:function(){this.setData({displayServiceEvaluation:!0})},inputBindFocus:function(){console.log("占位：函数 inputBindFocus 未声明")},inputBindBlur:function(){console.log("占位：函数 inputBindBlur 未声明")}}};t.default=s}).call(this,n("543d")["default"])},b8ff:function(e,t,n){"use strict";n.r(t);var a=n("8805"),s=n("e1ae");for(var i in s)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return s[e]}))}(i);n("29ab");var o=n("f0c5"),c=Object(o["a"])(s["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=c.exports},e1ae:function(e,t,n){"use strict";n.r(t);var a=n("b051"),s=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=s.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'page_chat/components/tui-chat/message-input/index-create-component',
    {
        'page_chat/components/tui-chat/message-input/index-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("b8ff"))
        })
    },
    [['page_chat/components/tui-chat/message-input/index-create-component']]
]);
